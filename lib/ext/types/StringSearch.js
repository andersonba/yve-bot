!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("isomorphic-unfetch"),require("../../core")):"function"==typeof define&&define.amd?define(["isomorphic-unfetch","../../core"],n):(e=e||self).YveBotTypesStringSearch=n(null,e.YveBot)}(this,function(e,n){"use strict";function t(u,i,a,l){return new(a||(a=Promise))(function(e,n){function t(e){try{o(l.next(e))}catch(e){n(e)}}function r(e){try{o(l.throw(e))}catch(e){n(e)}}function o(n){n.done?e(n.value):new a(function(e){e(n.value)}).then(t,r)}o((l=l.apply(u,i||[])).next())})}function s(t,r){var o,u,i,e,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return e={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function n(n){return function(e){return function(n){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,u&&(i=2&n[0]?u.return:n[0]?u.throw||((i=u.return)&&i.call(u),0):u.next)&&!(i=i.call(u,n[1])).done)return i;switch(u=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,u=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(i=0<(i=a.trys).length&&i[i.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){a.label=n[1];break}if(6===n[0]&&a.label<i[1]){a.label=i[1],i=n;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(n);break}i[2]&&a.ops.pop(),a.trys.pop();continue}n=r.call(t,a)}catch(e){n=[6,e],u=0}finally{o=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,e])}}}n=n&&n.hasOwnProperty("default")?n.default:n;var r=void 0;return n.types.defineExtension("StringSearch",{executors:[{},{transform:function(a,l,c){return t(r,void 0,void 0,function(){var n,t,r,o,u,i;return s(this,function(e){return n=l.config,t=n.apiURI,r=n.apiQueryParam,o=n.translate,u=n.messages,i=t+"?"+r+"="+encodeURIComponent(String(a)),c.dispatch("typing"),[2,fetch(i).then(function(e){return e.json()}).then(function(e){if(0===e.length)throw new c.exceptions.ValidatorError(u.noResults,l);return e}).then(function(e){if(!o)return e;var n=o.label,t=o.value;return e.map(function(e){return{label:e[n],value:e[t]}})})]})})}},{transform:function(o,u,i){return t(r,void 0,void 0,function(){var n,t,r;return s(this,function(e){throw n=u.config.messages,t=1===o.length?(r=n.didYouMean+": "+o[0].label+"?",[{label:n.yes,value:o[0].value},{label:n.no,value:null}]):(r=n.multipleResults+":",o.concat([{label:n.noneOfAbove,value:null}])),i.talk(r,{type:"SingleChoice",options:t}),new i.exceptions.PauseRuleTypeExecutors(u.name)})})}},{validators:[{function:function(e,n,t){var r=n.config.messages;if(!e)throw t.store.unset("executors."+n.name+".currentIdx"),t.talk(r.wrongResult),new t.exceptions.PauseRuleTypeExecutors(n.name);return!0}}]}]})});
