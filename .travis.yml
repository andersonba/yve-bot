language: node_js
node_js:
  - '15'
cache: yarn
script:
  - yarn lint
  - yarn test:coverage
  - coveralls < coverage/lcov.info
  - yarn clean
  - yarn build
  - yarn bundle
deploy:
  provider: script
  script:
    - git config --global user.name "${GH_NAME}"
    - git config --global user.email "${GH_EMAIL}"
    - echo "machine github.com login ${GH_NAME} password ${GH_TOKEN}" > ~/.netrc
    - cd website && yarn install && yarn build && GIT_USER="${GH_NAME}" yarn run publish-gh-pages
  on:
    branch: master
