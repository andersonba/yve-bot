!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("isomorphic-unfetch"),require("../../core")):"function"==typeof define&&define.amd?define(["isomorphic-unfetch","../../core"],n):(e="undefined"!=typeof globalThis?globalThis:e||self).YveBotTypesStringSearch=n(0,e.YveBot)}(this,function(e,n){"use strict";function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function c(e,i,a,l){return new(a=a||Promise)(function(t,n){function o(e){try{u(l.next(e))}catch(e){n(e)}}function r(e){try{u(l.throw(e))}catch(e){n(e)}}function u(e){var n;e.done?t(e.value):((n=e.value)instanceof a?n:new a(function(e){e(n)})).then(o,r)}u((l=l.apply(e,i||[])).next())})}function f(t,o){var r,u,i,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},e={next:n(0),throw:n(1),return:n(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function n(n){return function(e){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,u&&(i=2&n[0]?u.return:n[0]?u.throw||((i=u.return)&&i.call(u),0):u.next)&&!(i=i.call(u,n[1])).done)return i;switch(u=0,(n=i?[2&n[0],i.value]:n)[0]){case 0:case 1:i=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,u=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(!(i=0<(i=a.trys).length&&i[i.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){a.label=n[1];break}if(6===n[0]&&a.label<i[1]){a.label=i[1],i=n;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(n);break}i[2]&&a.ops.pop(),a.trys.pop();continue}n=o.call(t,a)}catch(e){n=[6,e],u=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,e])}}}return t(n).default.types.defineExtension("StringSearch",{executors:[{},{transform:function(i,a,l){return c(void 0,void 0,void 0,function(){var n,t,o,r,u;return f(this,function(e){return n=a.config,t=n.apiURI,u=n.apiQueryParam,o=n.translate,r=n.messages,u=t+"?"+u+"="+encodeURIComponent(String(i)),l.dispatch("typing"),[2,fetch(u).then(function(e){return e.json()}).then(function(e){if(0===e.length)throw new l.exceptions.ValidatorError(r.noResults,a);return e}).then(function(e){if(!o)return e;var n=o.label,t=o.value;return e.map(function(e){return{label:e[n],value:e[t]}})})]})})}},{transform:function(o,r,u){return c(void 0,void 0,void 0,function(){var n,t;return f(this,function(e){throw n=r.config.messages,n=1===o.length?(t=n.didYouMean+": "+o[0].label+"?",[{label:n.yes,value:o[0].value},{label:n.no,value:null}]):(t=n.multipleResults+":",o.concat([{label:n.noneOfAbove,value:null}])),u.talk(t,{type:"SingleChoice",options:n}),new u.exceptions.PauseRuleTypeExecutors(r.name)})})}},{validators:[{function:function(e,n,t){var o=n.config.messages;if(!e)throw t.store.unset("executors."+n.name+".currentIdx"),t.talk(o.wrongResult),new t.exceptions.PauseRuleTypeExecutors(n.name);return!0}}]}]})});
